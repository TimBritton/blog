<!DOCTYPE html><html><head><title>Blog | Kotlin custom DSL creation</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link href="https://fonts.googleapis.com/css?family=Hind:400,700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Hind', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/blog/styles/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/blog/bundle/codedoc-bundle.js"></script></head><body><div class="header-0-0-4"></div><div id="-codedoc-container" class="container"><h1 id="kotlin-custom-dsl-creation" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Kotlin custom DSL creation</h1><p>I am a pretty big proponent of Kotlin as a language and for the last three years, I have had the opportunity to build a platform utilizing Kotlin in conjunction with Vertx.  I think one of the best parts of Kotlin is you can always discover a better way of doing something.  In this article, I am going to discuss how to write a Kotlin DSL and provide a simple example of a DSL I wrote recently for one of my toy projects.</p><p>Let start by discussing what a DSL is in the first place.  DSL stands for <strong>D</strong>omain <strong>S</strong>pecific <strong>L</strong>anguage which I would further define as modifying the syntax of Kotlin to adhere to a given concept in your broader system.</p><p>Kotlin enables you to build these DSLs via specific language features the three features I want to highlight are <strong>Lambda Syntax</strong>, <strong>Higher-Order Functions</strong> and <strong>Extension Functions</strong>.</p><h2 id="lambda-syntax" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Lambda Syntax</h2><p>The syntax for Lambda Functions is different than other languages and has some built-in functionality that is unique.</p><pre class="with-bar"><code class="kotlin code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="val listOfLetters = listOf(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;).map{"><span class="lineCounter-0-0-12 prim">1</span><span class="token keyword">val</span> listOfLetters <span class="token operator">=</span> <span class="token function">listOf</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="it.toLowerCase()"><span class="lineCounter-0-0-12">2</span>it<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12">3</span><span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">4</span></div><br><div class="line-0-0-13 " data-content="//yields list [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]"><span class="lineCounter-0-0-12 prim">5</span><span class="token comment">//yields list ["a", "b", "c"]</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12 prim">6</span></div><br></code></pre><p>Note:</p><ul><li>The Lambda is not a parameter to map but is after the map function name.  </li><li>The input to the Lambda is automatically given a name <code>it</code></li></ul><h2 id="higher-order-functions" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Higher Order Functions</h2><p>Kotlin has higher-order functions which means you are able to pass functions into other functions</p><pre class="with-bar"><code class="kotlin code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12 prim">1</span></div><br><div class="line-0-0-13 " data-content="fun main(){"><span class="lineCounter-0-0-12">2</span><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content=" val b =  {"><span class="lineCounter-0-0-12">3</span> <span class="token keyword">val</span> b <span class="token operator">=</span>  <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    println(&quot;B&quot;)"><span class="lineCounter-0-0-12">4</span>    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12 prim">5</span><span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="    a(b)"><span class="lineCounter-0-0-12">6</span>    <span class="token function">a</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="//prints `B`"><span class="lineCounter-0-0-12">7</span><span class="token comment">//prints `B`</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12">8</span><span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="fun a(fn: () -> Unit){"><span class="lineCounter-0-0-12">9</span><span class="token keyword">fun</span> <span class="token function">a</span><span class="token punctuation">(</span>fn<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">)</span><span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    fn()"><span class="lineCounter-0-0-12 prim">10</span>    <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12 prim">11</span><span class="token punctuation">}</span></div><br></code></pre><h2 id="extension-functions" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Extension Functions</h2><p>Extension Functions allow you to expand other classes with new functionality without updating the class itself.</p><pre class="with-bar"><code class="kotlin code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="class Cat() {"><span class="lineCounter-0-0-12 prim">1</span><span class="token keyword">class</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12">2</span><span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">3</span></div><br><div class="line-0-0-13 " data-content="fun Cat.meow() {"><span class="lineCounter-0-0-12">4</span><span class="token keyword">fun</span> Cat<span class="token punctuation">.</span><span class="token function">meow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="println(&quot;MEOW&quot;)"><span class="lineCounter-0-0-12 prim">5</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MEOW"</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12">6</span><span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">7</span></div><br><div class="line-0-0-13 " data-content="fun main(){"><span class="lineCounter-0-0-12">8</span><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="val kitten = Cat()"><span class="lineCounter-0-0-12">9</span><span class="token keyword">val</span> kitten <span class="token operator">=</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12 prim">10</span></div><br><div class="line-0-0-13 " data-content="kitten.meow()"><span class="lineCounter-0-0-12">11</span>kitten<span class="token punctuation">.</span><span class="token function">meow</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="//prints `MEOW`"><span class="lineCounter-0-0-12">12</span><span class="token comment">//prints `MEOW`</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12 prim">13</span><span class="token punctuation">}</span></div><br></code></pre><h2 id="putting-it-together" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Putting it together</h2><p>When you combine these three features you are able to customize Kotlin to fit the needs of what you are working on.</p><p>For one of my toy projects, I'm working on I wrote a DSL for creating tables for generating random value objects.</p><p>When utilizing this DSL you can write the following:</p><pre class="with-bar"><code class="kotlin code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12 prim">1</span></div><br><div class="line-0-0-13 " data-content="   val COMMON_ACTION_COST_TABLE ="><span class="lineCounter-0-0-12">2</span>   <span class="token keyword">val</span> COMMON_ACTION_COST_TABLE <span class="token operator">=</span></div><br><div class="line-0-0-13 " data-content="        simpleTable<ActionCost>(&quot;Common Action Cost Table&quot;) {"><span class="lineCounter-0-0-12">3</span>        simpleTable<span class="token operator">&lt;</span>ActionCost<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">"Common Action Cost Table"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="            entry { 2.0 to ActionCost.ONE }"><span class="lineCounter-0-0-12">4</span>            entry <span class="token punctuation">{</span> <span class="token number">2.0</span> <span class="token keyword">to</span> ActionCost<span class="token punctuation">.</span>ONE <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="            entry { 30.0 to ActionCost.TWO }"><span class="lineCounter-0-0-12 prim">5</span>            entry <span class="token punctuation">{</span> <span class="token number">30.0</span> <span class="token keyword">to</span> ActionCost<span class="token punctuation">.</span>TWO <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="            entry { 20.0 to ActionCost.THREE }"><span class="lineCounter-0-0-12">6</span>            entry <span class="token punctuation">{</span> <span class="token number">20.0</span> <span class="token keyword">to</span> ActionCost<span class="token punctuation">.</span>THREE <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="            entry { 20.0 to ActionCost.FOUR }"><span class="lineCounter-0-0-12">7</span>            entry <span class="token punctuation">{</span> <span class="token number">20.0</span> <span class="token keyword">to</span> ActionCost<span class="token punctuation">.</span>FOUR <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="            entry { 18.0 to ActionCost.FIVE }"><span class="lineCounter-0-0-12">8</span>            entry <span class="token punctuation">{</span> <span class="token number">18.0</span> <span class="token keyword">to</span> ActionCost<span class="token punctuation">.</span>FIVE <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="            entry { 10.0 to ActionCost.SIX }"><span class="lineCounter-0-0-12">9</span>            entry <span class="token punctuation">{</span> <span class="token number">10.0</span> <span class="token keyword">to</span> ActionCost<span class="token punctuation">.</span>SIX <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="            validate()"><span class="lineCounter-0-0-12 prim">10</span>            <span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="        }"><span class="lineCounter-0-0-12">11</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12 prim">12</span></div><br></code></pre><p>What this code does is create a named table that associates a percentage to a give <code>ActionCost</code>.  You can then call <code>random()</code> to get a random value from the table where if you call it 100 times you will likely get <code>ActionCost.ONE</code> two percent of the time.</p><p>The class yielded by the simpleTable method is: </p><pre class="with-bar"><code class="kotlin code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="class Table<T>(val tableName: String) {"><span class="lineCounter-0-0-12 prim">1</span><span class="token keyword">class</span> Table<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">val</span> tableName<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    var tableEntries: MutableSet<Triple<Int, Int,  T>> = mutableSetOf()"><span class="lineCounter-0-0-12">2</span>    <span class="token keyword">var</span> tableEntries<span class="token operator">:</span> MutableSet<span class="token operator">&lt;</span>Triple<span class="token operator">&lt;</span>Int<span class="token punctuation">,</span> Int<span class="token punctuation">,</span>  T<span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token function">mutableSetOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="    var rawEntries: MutableSet<Pair<Double,  T>> = mutableSetOf()"><span class="lineCounter-0-0-12">3</span>    <span class="token keyword">var</span> rawEntries<span class="token operator">:</span> MutableSet<span class="token operator">&lt;</span>Pair<span class="token operator">&lt;</span>Double<span class="token punctuation">,</span>  T<span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token function">mutableSetOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">4</span></div><br><div class="line-0-0-13 " data-content="    internal fun addEntry(percentChance: Double, entry:T) {"><span class="lineCounter-0-0-12 prim">5</span>    <span class="token keyword">internal</span> <span class="token keyword">fun</span> <span class="token function">addEntry</span><span class="token punctuation">(</span>percentChance<span class="token operator">:</span> Double<span class="token punctuation">,</span> entry<span class="token operator">:</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="        rawEntries.add(percentChance to entry)"><span class="lineCounter-0-0-12">6</span>        rawEntries<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>percentChance <span class="token keyword">to</span> entry<span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="        val lastEntryEnding = if (tableEntries.isEmpty()) {"><span class="lineCounter-0-0-12">7</span>        <span class="token keyword">val</span> lastEntryEnding <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>tableEntries<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="            0"><span class="lineCounter-0-0-12">8</span>            <span class="token number">0</span></div><br><div class="line-0-0-13 " data-content="        } else {"><span class="lineCounter-0-0-12">9</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="            tableEntries.last().second"><span class="lineCounter-0-0-12 prim">10</span>            tableEntries<span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>second</div><br><div class="line-0-0-13 " data-content="        }"><span class="lineCounter-0-0-12">11</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">12</span></div><br><div class="line-0-0-13 " data-content="        val inted = (percentChance * 100).toInt()"><span class="lineCounter-0-0-12">13</span>        <span class="token keyword">val</span> inted <span class="token operator">=</span> <span class="token punctuation">(</span>percentChance <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="        if(lastEntryEnding+inted >= 10001){"><span class="lineCounter-0-0-12">14</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>lastEntryEnding<span class="token operator">+</span>inted <span class="token operator">&gt;=</span> <span class="token number">10001</span><span class="token punctuation">)</span><span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="            error(&quot;Table Malformed&quot;)"><span class="lineCounter-0-0-12 prim">15</span>            <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Table Malformed"</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="        }"><span class="lineCounter-0-0-12">16</span>        <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="        tableEntries.add(Triple(lastEntryEnding, lastEntryEnding + inted, entry))"><span class="lineCounter-0-0-12">17</span>        tableEntries<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">Triple</span><span class="token punctuation">(</span>lastEntryEnding<span class="token punctuation">,</span> lastEntryEnding <span class="token operator">+</span> inted<span class="token punctuation">,</span> entry<span class="token punctuation">)</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="    }"><span class="lineCounter-0-0-12">18</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">19</span></div><br><div class="line-0-0-13 " data-content="    fun random(): T {"><span class="lineCounter-0-0-12 prim">20</span>    <span class="token keyword">fun</span> <span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> T <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="        val rando = (0..10000).random()"><span class="lineCounter-0-0-12">21</span>        <span class="token keyword">val</span> rando <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">..</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="        return tableEntries.filter{"><span class="lineCounter-0-0-12">22</span>        <span class="token keyword">return</span> tableEntries<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="            return@filter (rando > it.first &amp;&amp; rando < it.second)"><span class="lineCounter-0-0-12">23</span>            <span class="token keyword">return</span><span class="token label symbol">@filter</span> <span class="token punctuation">(</span>rando <span class="token operator">&gt;</span> it<span class="token punctuation">.</span>first <span class="token operator">&amp;&amp;</span> rando <span class="token operator">&lt;</span> it<span class="token punctuation">.</span>second<span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="        }.first().third ?: error(&quot;Null when it shouldn't&quot;)"><span class="lineCounter-0-0-12">24</span>        <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>third <span class="token operator">?:</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Null when it shouldn't"</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="    }"><span class="lineCounter-0-0-12 prim">25</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12 prim">26</span><span class="token punctuation">}</span></div><br></code></pre><p><em>Note: I'm not working with doubles because rounding sucks.  Also wouldn't recommend using this on anything productive.</em></p><p>The DSL for constructing this data structure looks like so:</p><pre class="with-bar"><code class="kotlin code-0-0-11" tabindex="0"><span class="wmbar-0-0-14"><span></span><span></span><span></span><span></span></span><div class="line-0-0-13 " data-content="fun <T>simpleTable(tableName: String, x: Table<T>.() -> Unit): Table<T> {"><span class="lineCounter-0-0-12 prim">1</span><span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token function">simpleTable</span><span class="token punctuation">(</span>tableName<span class="token operator">:</span> String<span class="token punctuation">,</span> x<span class="token operator">:</span> Table<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">)</span><span class="token operator">:</span> Table<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    var table = Table<T>(tableName)"><span class="lineCounter-0-0-12">2</span>    <span class="token keyword">var</span> table <span class="token operator">=</span> Table<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="    x(table)"><span class="lineCounter-0-0-12">3</span>    <span class="token function">x</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="    return table;"><span class="lineCounter-0-0-12">4</span>    <span class="token keyword">return</span> table<span class="token punctuation">;</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12 prim">5</span><span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">6</span></div><br><div class="line-0-0-13 " data-content="fun <T> Table<T>.entry(e: () -> Pair<Double, T>){"><span class="lineCounter-0-0-12">7</span><span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Table<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span>e<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Pair<span class="token operator">&lt;</span>Double<span class="token punctuation">,</span> T<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    val entry = e()"><span class="lineCounter-0-0-12">8</span>    <span class="token keyword">val</span> entry <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="    this.addEntry(entry.first, entry.second)"><span class="lineCounter-0-0-12">9</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addEntry</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span>first<span class="token punctuation">,</span> entry<span class="token punctuation">.</span>second<span class="token punctuation">)</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12 prim">10</span><span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">11</span></div><br><div class="line-0-0-13 " data-content="fun <T> Table<T>.validate(): Boolean {"><span class="lineCounter-0-0-12">12</span><span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Table<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Boolean <span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="    var percent = 0.0"><span class="lineCounter-0-0-12">13</span>    <span class="token keyword">var</span> percent <span class="token operator">=</span> <span class="token number">0.0</span></div><br><div class="line-0-0-13 " data-content="    for(entry in rawEntries){"><span class="lineCounter-0-0-12">14</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>entry <span class="token keyword">in</span> rawEntries<span class="token punctuation">)</span><span class="token punctuation">{</span></div><br><div class="line-0-0-13 " data-content="        percent += entry.first"><span class="lineCounter-0-0-12 prim">15</span>        percent <span class="token operator">+=</span> entry<span class="token punctuation">.</span>first</div><br><div class="line-0-0-13 " data-content="    }"><span class="lineCounter-0-0-12">16</span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-13 " data-content=""><span class="lineCounter-0-0-12">17</span></div><br><div class="line-0-0-13 " data-content="    return percent == 100.0"><span class="lineCounter-0-0-12">18</span>    <span class="token keyword">return</span> percent <span class="token operator">==</span> <span class="token number">100.0</span></div><br><div class="line-0-0-13 " data-content="}"><span class="lineCounter-0-0-12 prim">19</span><span class="token punctuation">}</span></div><br></code></pre><p>The DSL is composed of two extension methods providing the easy to use and understandable structure and the final extension validates the data within the structure since we want the percentage to add to 100.</p><p>When I wrote this DSL I wanted to be able to visually identify potential bugs with the percentages I assigned to a given entity and be able to quickly make a change to what could be a pretty large set of entries.</p><p>Well thats all I got for now.  Until next time</p><script id="MmBMjyHHPM">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("MmBMjyHHPM", "PFhwqFF68841RB6Nunq1Zg==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div class="contentnav-0-0-9" data-no-search=""><a href="#kotlin-custom-dsl-creation" class="h1" data-content-highlight="kotlin-custom-dsl-creation">Kotlin custom DSL creation</a><a href="#lambda-syntax" class="h2" data-content-highlight="lambda-syntax">Lambda Syntax</a><a href="#higher-order-functions" class="h2" data-content-highlight="higher-order-functions">Higher Order Functions</a><a href="#extension-functions" class="h2" data-content-highlight="extension-functions">Extension Functions</a><a href="#putting-it-together" class="h2" data-content-highlight="putting-it-together">Putting it together</a></div></div><div id="-codedoc-toc" class="toc-0-0-6"><div class="content-0-0-7"><p><a href="/blog/">Home</a></p><div class="collapse-0-0-3 "><script id="tIVqWcIhdz">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("tIVqWcIhdz", "BW5/JozIUuMeRr9sjNL7zw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Articles</span><span class="icon-font closed">chevron_right</span></div><div class="content"><p><a href="/blog/docs/kotlin-dsl">Kotlin DSL</a>
<a href="/blog/docs/full-stack-dart">Full Stack Dart</a></p></div></div><div class="collapse-0-0-3 "><script id="Yh_jCWhXZH">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("Yh_jCWhXZH", "BW5/JozIUuMeRr9sjNL7zw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Socials</span><span class="icon-font closed">chevron_right</span></div><div class="content"><p><a href="https://github.com/TimBritton">Github</a>
<a href="https://www.twitter.com/Ziberath">Twitter</a></p></div></div></div></div><div class="footer-0-0-5"><div class="left"><script id="lgAxKQpEUG">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("lgAxKQpEUG", "k0lYj9deiYXngpZFqYY0vQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div><div class="main"><div class="inside"></div></div><div class="right"><script id="VtfqwXPevX">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("VtfqwXPevX", "QtGDrozMmpfzLYU0jY3n+w==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></div></div><script id="sCQuOmScWg">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("sCQuOmScWg", "Rs0VnrLCFSwfOm1o3R6OHg==", {"namespace":"/blog"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); })()</script></body></html>